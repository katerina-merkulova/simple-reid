==========
Config:AUG:
  RC_PROB: 0.5
  RE_PROB: 0.5
DATA:
  CUHK03_CLASSIC_SPLIT: False
  CUHK03_LABELED: False
  DATASET: market1501
  HEIGHT: 256
  NUM_INSTANCES: 4
  NUM_WORKERS: 4
  ROOT: data
  SPLIT_ID: 0
  TEST_BATCH: 512
  TRAIN_BATCH: 64
  WIDTH: 128
EVAL_MODE: False
GPU: 0,1
LOSS:
  CLA_LOSS: crossentropy
  CLA_M: 0.0
  CLA_S: 16.0
  PAIR_LOSS: triplet
  PAIR_M: 0.3
  PAIR_S: 16.0
MODEL:
  FEATURE_DIM: 2048
  NAME: resnet50
  RES4_STRIDE: 1
  RESUME: 
OUTPUT: logs/market1501/res50-ce-triplet
SEED: 0
TAG: res50-ce-triplet
TEST:
  DISTANCE: cosine
  EVAL_STEP: 5
  START_EVAL: 0
TRAIN:
  LR_SCHEDULER:
    DECAY_RATE: 0.1
    STEPSIZE: [20, 40]
  MAX_EPOCH: 60
  OPTIMIZER:
    LR: 0.00035
    NAME: adam
    WEIGHT_DECAY: 0.0005
  START_EPOCH: 0
==========
Currently using GPU 0,1
Initializing dataset market1501
=> Market1501 loaded
Dataset statistics:
  ------------------------------
  subset   | # ids | # images
  ------------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
  ------------------------------
  total    |  1501 |    32217
  ------------------------------
Initializing model: resnet50
Model size: 23.51213M
==> Start training
Epoch1 Time:36.6s Data:0.7s ClaLoss:5.3245 PairLoss:0.4066 Acc:10.94% 
Epoch2 Time:34.9s Data:0.7s ClaLoss:3.0986 PairLoss:0.2695 Acc:37.18% 
Epoch3 Time:35.1s Data:0.7s ClaLoss:1.8856 PairLoss:0.2176 Acc:58.95% 
Epoch4 Time:35.3s Data:0.6s ClaLoss:1.2651 PairLoss:0.1998 Acc:71.91% 
Epoch5 Time:35.5s Data:0.6s ClaLoss:0.9180 PairLoss:0.1818 Acc:79.14% 
==> Test
Extracted features for query set, obtained torch.Size([3368, 2048]) matrix
Extracted features for gallery set, obtained torch.Size([15913, 2048]) matrix
Extracting features complete in 0m 37s
Computing CMC and mAP
Results ----------------------------------------
top1:85.0% top5:94.8% top10:96.7% mAP:67.5%
------------------------------------------------
Epoch6 Time:35.4s Data:0.7s ClaLoss:0.7118 PairLoss:0.1766 Acc:84.00% 
Epoch7 Time:35.4s Data:0.7s ClaLoss:0.5904 PairLoss:0.1686 Acc:86.55% 
Epoch8 Time:35.6s Data:0.6s ClaLoss:0.4944 PairLoss:0.1645 Acc:88.67% 
Epoch9 Time:36.5s Data:0.7s ClaLoss:0.4406 PairLoss:0.1566 Acc:90.11% 
Epoch10 Time:36.5s Data:0.7s ClaLoss:0.3606 PairLoss:0.1513 Acc:91.74% 
==> Test
Extracted features for query set, obtained torch.Size([3368, 2048]) matrix
Extracted features for gallery set, obtained torch.Size([15913, 2048]) matrix
Extracting features complete in 0m 36s
Computing CMC and mAP
Results ----------------------------------------
top1:87.9% top5:95.7% top10:97.3% mAP:73.2%
------------------------------------------------
Epoch11 Time:35.5s Data:0.7s ClaLoss:0.3433 PairLoss:0.1488 Acc:92.43% 
Epoch12 Time:35.9s Data:0.7s ClaLoss:0.3161 PairLoss:0.1454 Acc:93.39% 
Epoch13 Time:36.5s Data:0.7s ClaLoss:0.2972 PairLoss:0.1431 Acc:93.63% 
Epoch14 Time:36.8s Data:0.7s ClaLoss:0.2752 PairLoss:0.1412 Acc:94.05% 
Epoch15 Time:36.7s Data:0.7s ClaLoss:0.2665 PairLoss:0.1362 Acc:94.22% 
==> Test
Extracted features for query set, obtained torch.Size([3368, 2048]) matrix
Extracted features for gallery set, obtained torch.Size([15913, 2048]) matrix
Extracting features complete in 0m 36s
Computing CMC and mAP
Results ----------------------------------------
top1:89.0% top5:96.7% top10:98.0% mAP:74.9%
------------------------------------------------
Epoch16 Time:35.4s Data:0.7s ClaLoss:0.2625 PairLoss:0.1352 Acc:94.55% 
Epoch17 Time:35.6s Data:0.6s ClaLoss:0.2463 PairLoss:0.1337 Acc:94.54% 
Epoch18 Time:36.5s Data:0.7s ClaLoss:0.2409 PairLoss:0.1344 Acc:94.78% 
Epoch19 Time:36.6s Data:0.7s ClaLoss:0.2236 PairLoss:0.1294 Acc:95.31% 
Epoch20 Time:36.3s Data:0.7s ClaLoss:0.2379 PairLoss:0.1332 Acc:95.05% 
==> Test
Extracted features for query set, obtained torch.Size([3368, 2048]) matrix
Extracted features for gallery set, obtained torch.Size([15913, 2048]) matrix
Extracting features complete in 0m 37s
Computing CMC and mAP
Results ----------------------------------------
top1:90.1% top5:96.5% top10:97.9% mAP:76.4%
------------------------------------------------
Epoch21 Time:35.6s Data:0.7s ClaLoss:0.1355 PairLoss:0.1087 Acc:97.55% 
Epoch22 Time:36.1s Data:0.7s ClaLoss:0.0948 PairLoss:0.0885 Acc:98.39% 
Epoch23 Time:36.9s Data:0.7s ClaLoss:0.0780 PairLoss:0.0810 Acc:98.82% 
Epoch24 Time:36.9s Data:0.7s ClaLoss:0.0790 PairLoss:0.0792 Acc:98.75% 
Epoch25 Time:36.5s Data:0.7s ClaLoss:0.0630 PairLoss:0.0705 Acc:99.11% 
==> Test
Extracted features for query set, obtained torch.Size([3368, 2048]) matrix
Extracted features for gallery set, obtained torch.Size([15913, 2048]) matrix
Extracting features complete in 0m 36s
Computing CMC and mAP
Results ----------------------------------------
top1:93.7% top5:97.8% top10:98.8% mAP:84.5%
------------------------------------------------
Epoch26 Time:35.6s Data:0.7s ClaLoss:0.0650 PairLoss:0.0682 Acc:98.98% 
Epoch27 Time:36.1s Data:0.7s ClaLoss:0.0621 PairLoss:0.0681 Acc:99.11% 
Epoch28 Time:36.4s Data:0.7s ClaLoss:0.0562 PairLoss:0.0617 Acc:99.19% 
Epoch29 Time:36.8s Data:0.6s ClaLoss:0.0590 PairLoss:0.0628 Acc:99.19% 
