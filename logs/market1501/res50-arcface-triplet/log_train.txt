==========
Config:AUG:
  RC_PROB: 0.5
  RE_PROB: 0.5
DATA:
  CUHK03_CLASSIC_SPLIT: False
  CUHK03_LABELED: False
  DATASET: market1501
  HEIGHT: 256
  NUM_INSTANCES: 4
  NUM_WORKERS: 4
  ROOT: data
  SPLIT_ID: 0
  TEST_BATCH: 512
  TRAIN_BATCH: 64
  WIDTH: 128
EVAL_MODE: False
GPU: 0,1
LOSS:
  CLA_LOSS: arcface
  CLA_M: 0.1
  CLA_S: 16.0
  PAIR_LOSS: triplet
  PAIR_M: 0.3
  PAIR_S: 16.0
MODEL:
  FEATURE_DIM: 2048
  NAME: resnet50
  RES4_STRIDE: 1
  RESUME: 
OUTPUT: logs/market1501/res50-arcface-triplet
SEED: 0
TAG: res50-arcface-triplet
TEST:
  DISTANCE: cosine
  EVAL_STEP: 5
  START_EVAL: 0
TRAIN:
  LR_SCHEDULER:
    DECAY_RATE: 0.1
    STEPSIZE: [20, 40]
  MAX_EPOCH: 30
  OPTIMIZER:
    LR: 0.00035
    NAME: adam
    WEIGHT_DECAY: 0.0005
  START_EPOCH: 0
==========
Currently using GPU 0,1
Initializing dataset market1501
=> Market1501 loaded
Dataset statistics:
  ------------------------------
  subset   | # ids | # images
  ------------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
  ------------------------------
  total    |  1501 |    32217
  ------------------------------
Initializing model: resnet50
Model size: 23.51213M
==> Start training
Epoch1 Time:38.6s Data:0.7s ClaLoss:7.0324 PairLoss:0.4188 Acc:9.68% 
Epoch2 Time:36.9s Data:0.7s ClaLoss:4.9629 PairLoss:0.2613 Acc:32.15% 
Epoch3 Time:37.2s Data:0.6s ClaLoss:3.6056 PairLoss:0.1999 Acc:53.31% 
Epoch4 Time:37.1s Data:0.7s ClaLoss:2.7394 PairLoss:0.1676 Acc:66.87% 
Epoch5 Time:36.8s Data:0.6s ClaLoss:2.1489 PairLoss:0.1452 Acc:76.22% 
==> Test
Extracted features for query set, obtained torch.Size([3368, 2048]) matrix
Extracted features for gallery set, obtained torch.Size([15913, 2048]) matrix
Extracting features complete in 0m 37s
Computing CMC and mAP
Results ----------------------------------------
top1:87.4% top5:94.8% top10:96.7% mAP:72.2%
------------------------------------------------
Epoch6 Time:35.8s Data:0.7s ClaLoss:1.7521 PairLoss:0.1314 Acc:82.21% 
Epoch7 Time:36.4s Data:0.7s ClaLoss:1.4411 PairLoss:0.1148 Acc:86.54% 
Epoch8 Time:37.1s Data:0.7s ClaLoss:1.2338 PairLoss:0.1071 Acc:89.11% 
Epoch9 Time:37.1s Data:0.7s ClaLoss:1.0982 PairLoss:0.0988 Acc:91.02% 
Epoch10 Time:36.8s Data:0.7s ClaLoss:0.9715 PairLoss:0.0928 Acc:92.31% 
==> Test
Extracted features for query set, obtained torch.Size([3368, 2048]) matrix
Extracted features for gallery set, obtained torch.Size([15913, 2048]) matrix
Extracting features complete in 0m 36s
Computing CMC and mAP
Results ----------------------------------------
top1:90.8% top5:96.8% top10:98.0% mAP:78.6%
------------------------------------------------
